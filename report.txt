import org.apache.spark.sql.DataFrameWriterV2

private def applyTableProperties[T](
  w: DataFrameWriterV2[T],
  props: Map[String, String]
): DataFrameWriterV2[T] =
  props.foldLeft(w) { case (acc, (k, v)) => acc.tableProperty(k, v) }


import org.apache.spark.sql.DataFrameWriterV2

private def applyTableProperties(
  w: DataFrameWriterV2[_],
  props: Map[String, String]
): DataFrameWriterV2[_] =
  props.foldLeft(w) { case (acc, (k, v)) => acc.tableProperty(k, v) }
