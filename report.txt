import org.apache.spark.sql.DataFrameWriterV2

private def applyTableProperties(
  w: DataFrameWriterV2[_],
  props: Map[String, String]
): DataFrameWriterV2[_] = {
  props.foldLeft(w) { case (acc, (k, v)) =>
    acc.tableProperty(k, v).asInstanceOf[DataFrameWriterV2[_]]
  }
}
