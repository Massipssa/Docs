 test("should return None if column count <= directiveColumnCount") {
    val df: DataFrame = Seq((1, "A"), (2, "B")).toDF("_c0", "_c1")
    val result = MinimalColumnCountCheck.check(df, directiveColumnCount = 3)

    assert(result.isEmpty)
  }

  test("should return error if column count > directiveColumnCount") {
    val df: DataFrame = Seq((1, "A", "X"), (2, "B", "Y")).toDF("_c0", "_c1", "_c2")
    val result = MinimalColumnCountCheck.check(df, directiveColumnCount = 2)

    assert(result.isDefined)
    assert(result.get.actual.contains("CSV file with 3 columns"))
    assert(result.get.expected.contains("CSV file with maximum 2 columns"))
  }
