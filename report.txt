import React, { useState } from 'react';
import { TextField, Box, Popper, Paper } from '@mui/material';
import { DateRange } from 'react-date-range';
import { addDays } from 'date-fns';
import 'react-date-range/dist/styles.css'; // main css file
import 'react-date-range/dist/theme/default.css'; // theme css file

function CustomDateRangePicker() {
  const [anchorEl, setAnchorEl] = useState(null);
  const [selectedRange, setSelectedRange] = useState({
    startDate: new Date(),
    endDate: addDays(new Date(), 7),
    key: 'selection',
  });

  const handleRangeChange = (ranges) => {
    setSelectedRange(ranges.selection);
  };

  const handleInputClick = (event) => {
    setAnchorEl(anchorEl ? null : event.currentTarget);
  };

  const handleClose = () => {
    setAnchorEl(null);
  };

  const open = Boolean(anchorEl);
  const id = open ? 'date-range-popper' : undefined;

  return (
    <Box>
      <TextField
        aria-describedby={id}
        value={`${selectedRange.startDate.toLocaleDateString()} - ${selectedRange.endDate.toLocaleDateString()}`}
        onClick={handleInputClick}
        fullWidth
        placeholder="MM/DD/YYYY - MM/DD/YYYY"
        readOnly
      />

      <Popper id={id} open={open} anchorEl={anchorEl} placement="bottom-start" onClickAway={handleClose}>
        <Paper>
          <DateRange
            ranges={[selectedRange]}
            onChange={handleRangeChange}
            moveRangeOnFirstSelection={false}
            editableDateInputs={true}
          />
        </Paper>
      </Popper>
    </Box>
  );
}

export default CustomDateRangePicker;
