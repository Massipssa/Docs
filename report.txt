import React, { useContext, useState } from 'react';
import { CreContext } from './CreContext';

const SyntheseFilter = () => {
  const { setSubmittedValues } = useContext(CreContext); // Use context to set submitted values
  const [submittedValues, setLocalSubmittedValues] = useState({
    integrationDate: new Date(),
    activityDate: setYesterday(),
    frequency: '',
    project: '',
  });

  const handleDrawerSubmit = (values) => {
    const finalValues = {
      integrationDate: values.integrationDate,
      activityDate: values.activityDate,
      frequency: values.frequency,
      project: values.project,
    };
    setLocalSubmittedValues(finalValues); // Local state for UI
    setSubmittedValues(finalValues); // Update context state for API call
  };

  return (
    <div>
      <SyntheseDrawer onSubmit={handleDrawerSubmit} />
      {submittedValues && (
        <Box sx={{ flexGrow: 1, p: 3 }}>
          <CssBaseline />
          <Grid container spacing={3}>
            <DateCards values={submittedValues} />
            <CreAndVacationStatusCards values={submittedValues} />
            <CreAndProjectsCards values={submittedValues} />
          </Grid>
        </Box>
      )}
    </div>
  );
};

export default SyntheseFilter;
