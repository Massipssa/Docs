import React from 'react';
import MaterialReactTable from 'material-react-table';
import { Box, Grid, TextField, TablePagination, MenuItem, Select, FormControl, InputLabel } from '@mui/material';

const ExampleTable = () => {
  const columns = [
    { accessorKey: 'name', header: 'Name' },
    { accessorKey: 'age', header: 'Age' },
    { accessorKey: 'email', header: 'Email' }
  ];

  const data = [
    { name: 'John Doe', age: 28, email: 'john@example.com' },
    { name: 'Jane Smith', age: 34, email: 'jane@example.com' },
    { name: 'Alice Johnson', age: 45, email: 'alice@example.com' }
  ];

  const {
    tableInstance, // get the table instance
  } = useMaterialTable({
    data,
    columns,
    enableGlobalFilter: true,  // Enable the search bar
    enablePagination: true,    // Enable pagination
  });

  const CustomPagination = ({ tableInstance }) => {
    const {
      state: { pagination },
      setPagination,
    } = tableInstance;

    return (
      <TablePagination
        rowsPerPageOptions={[5, 10, 25]}
        component="div"
        count={tableInstance.getPaginationRowModel().rows.length}
        rowsPerPage={pagination.pageSize}
        page={pagination.pageIndex}
        onPageChange={(event, newPage) => setPagination({ ...pagination, pageIndex: newPage })}
        onRowsPerPageChange={(event) => setPagination({ ...pagination, pageSize: parseInt(event.target.value, 10) })}
        labelRowsPerPage="Rows per page:"  // Custom label for rows per page
        labelDisplayedRows={({ from, to, count }) => `${from}-${to} of ${count}`}
        SelectComponent={(props) => (
          <FormControl variant="outlined">
            <InputLabel>Rows per page</InputLabel>
            <Select
              {...props}
              label="Rows per page"
              sx={{ maxWidth: 150 }}
            >
              {props.options.map((option) => (
                <MenuItem key={option.value} value={option.value}>
                  {option.label}
                </MenuItem>
              ))}
            </Select>
          </FormControl>
        )}
      />
    );
  };

  return (
    <Box sx={{ padding: 3 }}>
      <MaterialReactTable
        tableInstance={tableInstance}
        positionPagination="top"
        renderTopToolbarCustomActions={() => (
          <Grid container spacing={2} alignItems="center">
            <Grid item xs>
              {/* Search bar aligned to the left */}
              <TextField
                value={tableInstance.state.globalFilter ?? ''}
                onChange={(event) => tableInstance.setGlobalFilter(event.target.value)}
                placeholder="Search..."
                sx={{ width: '100%' }}
              />
            </Grid>
            <Grid item>
              {/* Custom pagination component aligned to the right */}
              <CustomPagination tableInstance={tableInstance} />
            </Grid>
          </Grid>
        )}
      />
    </Box>
  );
};

const App = () => {
  return <ExampleTable />;
};

export default App;
