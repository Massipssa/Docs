val spark = SparkSession.builder()
  .appName("Spark with MinIO")
  .master("local[*]")
  .config("spark.hadoop.fs.s3a.endpoint", "http://127.0.0.1:9000") // Replace with your endpoint
  .config("spark.hadoop.fs.s3a.access.key", "your-access-key")
  .config("spark.hadoop.fs.s3a.secret.key", "your-secret-key")
  .config("spark.hadoop.fs.s3a.path.style.access", "true") // Required for MinIO
  .config("spark.hadoop.fs.s3a.connection.ssl.enabled", "false") // If not using HTTPS
  .getOrCreate()
